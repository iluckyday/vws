name: Make V2Ray up-to-date
on: push

jobs:
  push:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: compare version
        run: |
          set -x
          LOCAL_V2RAY_VER="$(cat version.txt)"
          REMOTE_V2RAY_VER="$(wget --no-check-certificate -q -O- https://api.github.com/repos/v2ray/v2ray-core/releases/latest | awk -F'"' '/tag_name/ {print $4}')"
          [ "$LOCAL_V2RAY_VER" != "$REMOTE_V2RAY_VER" ] && exit 0 || exit 1
      - name: auto commit
        if: success()
        run: |
          echo gogogo
